<html>
<head>
<title>Simple Shift Plot</title>
<!-- <script src="d3/d3.js" charset="utf-8"></script> -->
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="plotShift.js" charset="utf-8"></script>
<script src="shift.js" charset="utf-8"></script>
  <style>
    body {
      font-family: Verdana,Arial,sans-serif;
    }

    h4 {
    font-size: .8em;
    margin: 60px 0 5px 0;
    }

    h5 {
    font-size: .8em;
    margin: 10px 0 5px 0;
    }

    body {
    min-width: 650px;
    }

    #caption01 {
      width: 500px;
    }

    #figure01 {
      width: 600px;
    }

    .domain {
      fill: none;
      stroke: black;
      stroke-width: 2;
     }

  </style>
</head>
<body>

<div id="header"></div>
<!-- <h4>Select the reference: <select id="refSelect"><option value="none">none</option></select> Select the comparison: <select id="compSelect"><option value="none">none</option></select></h4> -->
<center>

<div id="caption01" class="figure">
Click on the graph and drag up to reveal additional words.</div>

<div id="figure01" class="figure"></div>

</center>

<div id="footer"></div>

<script>
function initializeDrop() {
    loadCsv();
}

function loadCsv() {
var csvLoadsRemaining = 4;
d3.text("tuesdayFvec.csv", function(text) {
    var tmp = text.split("\n");
    refF = tmp;
    if (!--csvLoadsRemaining) shiftAndPlot(d3.select("#figure01"),refF,compF,lens,words);
});
d3.text("labMTvec.csv", function(text) {
    var tmp = text.split("\n");
    lens = tmp;
    if (!--csvLoadsRemaining) shiftAndPlot(d3.select("#figure01"),refF,compF,lens,words);
});
d3.text("labMTwords.csv", function(text) {
    var tmp = text.split("\n");
    words = tmp;
    if (!--csvLoadsRemaining) shiftAndPlot(d3.select("#figure01"),refF,compF,lens,words);
});
d3.text("saturdayFvec.csv", function(text) {
    var tmp = text.split("\n");
    compF = tmp;
    if (!--csvLoadsRemaining) shiftAndPlot(d3.select("#figure01"),refF,compF,lens,words);
});

/* // all the data is three files, preprocessed
var csvLoadsRemaining = 3;
d3.text("sampleSortedMag.csv", function(text) {
    tmp = text.split("\n");
    // convert to percentage of shift
    totalMag = 0.0;
    for (var i=0; i<1000; i++){
      totalMag += parseFloat(tmp[i]);
    }
    //console.log(totalMag);
    sortedMag = tmp.slice(0,200).map(parseFloat);
    for (var i=0; i<200; i++){
      sortedMag[i] = sortedMag[i]/totalMag*100;
    }
    //sortedMag.forEach(function(d) { return d/totalMag; } );
    if (!--csvLoadsRemaining) plotShift(d3.select("#figure01"),sortedMag,sortedType,sortedWords);
}); 
d3.text("sampleSortedType.csv", function(text) {
    tmp = text.split("\n");
    sortedType = tmp.slice(0,200);
    if (!--csvLoadsRemaining) plotShift(d3.select("#figure01"),sortedMag,sortedType,sortedWords);
}); 
d3.text("sampleSortedWords.csv", function(text) {
    tmp = text.split("\n");
    sortedWords = tmp.slice(0,200);
    if (!--csvLoadsRemaining) plotShift(d3.select("#figure01"),sortedMag,sortedType,sortedWords); 
}); */

};

function shiftAndPlot(figure,refF,compF,lens,words) {

    shiftObj = shift(refF,compF,lens,words);
    plotShift(figure,shiftObj.sortedMag,
              shiftObj.sortedType,shiftObj.sortedWords);

};

initializeDrop();

</script>
  <!-- <style> -->
  <!--   .domain { -->
  <!--     stroke-width: 0.5; -->
  <!--    } -->

  <!-- </style> -->

</body>
</html>


